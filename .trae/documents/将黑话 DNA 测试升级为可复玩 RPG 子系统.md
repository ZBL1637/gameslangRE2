## 目标
- 把现有“黑话 DNA 测试”从能用的问卷，升级为有采样、即时奖励、职业称号、可复玩题池的轻量 RPG 子系统。
- 统一暗色底 + 荧光青主线 + 电紫能量 + 琥珀金奖励的视觉语言；保持移动端友好。
- 所有新增/改动函数提供函数级注释。

## 代码入口与现状定位
- 入口/题目/进度条：`src/pages/PlayerTown/components/interactive/DNATest.tsx:114-152`（右上角关闭、进度条、介绍页与题目渲染）
- 样式：`src/pages/PlayerTown/components/interactive/DNATest.scss:6-143`（模态与进度条、卡片）
- 结果页：`src/pages/PlayerTown/components/interactive/DNAReport.tsx`（组件 33、分享文案 123、标签与采样 183-225）
- 入口触发/完成切换：`src/pages/PlayerTown/PlayerTown.tsx:63-81`、条件渲染：`165-181`
- 题库与权重（现有）：`src/pages/PlayerTown/data.ts`（`DNA_QUESTIONS` 等）
- 参考配置：`reference/quizgame.json`（分层抽题、权重、职业标题、分享模板等）

## 交互设计增强
- 入口弹窗（介绍页）
  - 文案追加“8 题 · 约 30 秒 · 不记录个人信息（仅生成本次报告）”。
  - 标题下“系统提示”小字：系统：我们将从你的“开黑常用语”中提取 8 段 DNA 片段。
  - 增加“样本管/芯片”图标（荧光青主色 + 电紫外发光）。
  - 右上角 X 改为二次确认弹窗：退出鉴定（不会保存进度）/ 继续鉴定；主按钮荧光青实心，次按钮描边。
- 题目页通用框架
  - 进度条改为“8 段 DNA 采样条”，当前题段有荧光青→电紫的细流光；右上文案改为“样本 1 / 8”。
  - 下一题按钮禁用态：不透明度降低、禁用 hover、文案改“请选择 1 项”；激活瞬时“充能亮起”（描边与微光晕，上浮 2px）。
  - 选项卡选中态增强：整卡荧光青边框 + 外圈电紫薄辉光；内层淡荧光青能量高光；右侧出现 ✓ 或芯片小图标；点击 120ms 压下反馈。
  - 第 8 题为多选题：标题下“已选 0/2”（数字荧光青），选满后其他选项禁用并提示 tooltip（标题琥珀金点亮）。
  - 底部淡提示（首次出现后可隐藏）：↑↓ 选择 Enter 确认 Esc 退出。
- 每题“采样奖励”
  - 点“下一题”后出现 0.6s 过渡层 toast：DNA 片段 +1（琥珀金），并展示本题抽取关键词（荧光青）；少量电紫粒子。

## 游戏内容增强
- 选项嵌入“可解释黑话关键词”
  - 每个选项高亮 1 个术语（加粗+下划线+荧光青），hover 弹出解释卡（暗底、标题琥珀金、正文白字）。
  - 术语解释来自数据库/词典（沿用你现有 DataProcessor 与术语索引）。
- 题池抽题（可复玩）
  - 依据 `reference/quizgame.json.quiz.questionDraw` 实现分层随机：`stratified_random` 抽 8 题，维度覆盖。
  - 支持 `seedStrategy: user_session` 保持一次会话内可复现。
  - 保留现有题型，新增两类核心黑话题：翻译题（选“人话意思”）与场景题（选最可能脱口而出的黑话）。
- 评分与职业称号
  - 使用 `quizgame.json.scoring` 权重聚合（轴/trait），百分比归一与取整；ties 规则照配置。
  - 结果页增加职业称号条（如：休闲系·酒馆气氛组），来自 `results.axisProfiles`。

## 前端样式统一（Design Tokens）
- 新增 CSS Variables（或 SCSS variables）并在全局引入：
  - `--bg-0: #0A0D12`、`--bg-1: #0F1624`、`--panel: rgba(15,22,36,.72)`、`--stroke: rgba(58,242,255,.28)`、`--primary: #3AF2FF`、`--secondary: #B26BFF`、`--accent: #FFD84D`、`--danger: #FF4D6D`、`--success: #34FF92`、`--text: #EAF0FF`、`--muted: rgba(234,240,255,.62)`。
- 组件规格：弹窗宽 720–860px（桌面）、移动端全屏；统一圆角/间距/字号层级（标题 36–42、选项 18–20、辅助 14–16）。
- 玻璃卡材质：暗黑→深靛克制渐变，叠加 2–4% 噪点纹理；选项卡 hover 出现横向扫光（荧光青混电紫）。
- 按钮语义：主按钮始终荧光青 + 电紫外发光；次按钮为描边；长列表粘底。

## 结果页增强
- 顶部结论区：职业称号（荧光青）+ 琥珀金小徽章 + 一句话解释（`oneLiner`）。
- 标签（Trait）可点击：弹出“触发原因”卡（指向某题选项）与“相关黑话”；标题琥珀金、小分隔线荧光青弱描边。
- “黑话片段·随机采样”增加“换一条”（描边按钮）与“加入我的词库”（琥珀金徽章按钮）。
- 分享海报生成：预览弹窗（1080×1920），内容包含职业称号、圆环、百分比、标签与自动文案；支持保存/复制。

## 实施步骤（文件级改动）
1. `DNATest.tsx`
  - 入口页：追加系统提示与时间/隐私文案；X 关闭改为二次确认；引入样本图标。
  - 进度条：实现 8 段 DNA 采样条（逻辑与动画）；右上“样本 n / 8”。
  - 选项卡：选中态与按下反馈；多选题计数器与禁用逻辑；键盘提示。
  - 奖励 toast：在 `handleNext` 中插入过渡层状态与动画；关键词来源于当前题选项高亮术语。
  - 分层抽题：新增 `useQuizConfig()` 读取 `quizgame.json`，按 strata 组装本次题单。
2. `DNATest.scss`
  - Tokens 替换与新增材质层（噪点、扫光）；按钮/卡片/进度条动画与样式。
3. `data.ts`
  - 迁移/拼接题库：保留现有题，合并 `quizgame.json.questions` 形成题池；补充翻译题与场景题。
4. `DNAReport.tsx`
  - 顶部结论区与职业称号条；Trait 点击弹卡；“换一条/加入词库”按钮；分享海报预览。
5. `PlayerTown.tsx`
  - 入口与关闭流的轻微对接（如奖励后提示继续探索）。
6. 全局/组件样式
  - 引入统一 CSS Variables；调整弹窗宽度与响应式。

## 数据/类型与工具
- 新增 `QuizConfig` 类型（题池、抽题策略、权重、职业配置）。
- 读取 `reference/quizgame.json`（一次性加载或懒加载），兼容现有 `DNA_QUESTIONS`。
- 术语解释沿用 DataProcessor（按 term 或 glossaryKey 查），与浮词组件一致的颜色映射。

## 验证与交付
- 单元/交互测试：
  - 分层抽题覆盖率与禁用逻辑；多选计数；奖励 toast 出现与消失；结果百分比归一化与职业映射。
- 视觉验收：桌面与移动端；暗底材质与发光不过度；按钮语义清晰。
- 预览与性能：Vite 预览，确保动画不过度掉帧。

## 约束与约定
- 全部新增/改动函数均添加函数级注释；不记录个人信息；保留可回退的开关（如禁用奖励层）。
- 保持与现有色彩系统兼容；不引入新依赖（若必须，引入前先评估）。

请确认以上方案，确认后我将按“实施步骤”推进具体代码改造，并逐步验证。