
## A. 准备与对齐（0.5–1 天）

1. **梳理现状**
   * [ ] 读一遍当前 `TranslationTower.tsx` 状态机/路由切换逻辑（Intro/Hub/Challenge/Final/Outro）
   * [ ] 列出当前复用组件：`layout/Overview`、`layout/ChallengeHub`、`layout/FinalTask`、`challenges/*`
   * [ ] 标注“不可改”资源：开场动画入口组件、背景层（Canvas/Video/图片）
2. **定义重制目标验收标准（写进注释/PRD小段）**
   * [ ] 章节可完整跑通：Intro→F0→F1→F2→F3→F4→Settlement
   * [ ] 三条数值轴（Comms/Clarity/Culture）全程可见且随选择实时变化
   * [ ] Phrasebook 可收集词条，Boss 战可调用
   * [ ] Boss 由“单选题”改为“槽位拼装”并即时反馈

---

## B. 数据层重制（1 天）

3. **重构 `data.ts`（只动数据，不动 UI）**
   * [ ] 新增 `chapter5.meta`（id/title/floors/rewardSkill）
   * [ ] 新增 `hud.gauges` 配置
   * [ ] 新增 NPC 文案与状态（master/ali）
   * [ ] 新增 F0：`bazaarMistranslationCards[]`（至少 6 张）
   * [ ] 改造 F1：`keywordChallenge.items[]`（加 strategy 标签、掉落 rune）
   * [ ] 改造 F2：`styleChallenge.items[]`（异化/归化、gloss 次数）
   * [ ] 改造 F3：`metaphorChallenge.pairs[]`（可拖拽配对）
   * [ ] 新增 F4：`bossAssembler.slots[]`（5 槽位，每槽 3–4 个短语候选）
4. **补齐文案脚本（按段落 ID）**
   * [ ] Intro 接入层对白（master/ali）
   * [ ] Hub 两条系统提示（词典/提示券）
   * [ ] 每层通关语 `floor_clear_*`
   * [ ] Boss 成功/失败反馈语（至少 3 条变体）
   * [ ] Settlement 奖励技能说明 + 结局台词

---

## C. 状态机与全章全局状态（1–1.5 天）

5. **重写 `TranslationTower.tsx` 状态机**
   * [ ] 新增楼层枚举：`F0_BAZAAR / F1_KEYWORD / F2_STYLE / F3_METAPHOR / F4_BOSS`
   * [ ] Intro 结束后：淡入 HUD 与对话框（不改动画，只加 overlay）
   * [ ] 增加全局 state：
     * [ ] `comms`（初始 100）
     * [ ] `clarity`（初始 50）
     * [ ] `culture`（初始 50）
     * [ ] `runes[]`（空）
     * [ ] `hintTickets`（0）
     * [ ] `phrasebook[]`（空）
     * [ ] `floorProgress`（解锁/通关状态）
   * [ ] 写通用更新函数：
     * [ ] `applyDelta({ comms, clarity, culture })`
     * [ ] `addRune(type)`
     * [ ] `addPhrase(term)`
     * [ ] `addHintTicket()`
   * [ ] 失败重试机制：
     * [ ] `comms<=0` 弹出 “沟通崩溃/重试本层”弹窗
     * [ ] 允许本层重来但保留 phrasebook（可选：保留/不保留 rune）

---

## D. HUD 与塔身进度（0.5–1 天）

6. **新增 `components/layout/HUD.tsx`（或复用现有 HUD）**
   * [ ] 顶栏显示：章节名/楼层名
   * [ ] 三条进度条：Comms/Clarity/Culture（数值+条）
   * [ ] 右侧塔身灯条：5 段（F0–F4），当前层闪烁，通关变亮
   * [ ] Phrasebook 快捷入口（icon+数量）
7. **动效与层级**
   * [ ] HUD 淡入（0.6s）
   * [ ] 不遮挡背景关键视觉（留出顶部与右侧安全区）
   * [ ] 确认 z-index：背景 < 动画层 < HUD/面板

---

## E. F0 集市 Hub 重制（1–2 天）

8. **改造 `layout/Overview` → `BazaarHub`（尽量保留原布局）**
   * [ ] 左侧导航：集市总览 + F1–F4（锁定/解锁）
   * [ ] 中央主面板改为两列：
     * [ ] 误译委托板（卡片列表）
     * [ ] 玩家频道（招募信息流）
   * [ ] 右侧面板：
     * [ ] 阿里头像三态（困惑/半懂/恍然）
     * [ ] Phrasebook 列表（可滚动）
9. **误译委托板交互**
   * [ ] 卡片点击展开 → 3 选 1
   * [ ] 选择后即时显示 explain（1–2 行）
   * [ ] 正确：`applyDelta` + 掉落提示券概率动画（“获得提示券”）
   * [ ] 错误：`applyDelta`（comms -x）+ 阿里吐槽一句
10. **玩家频道交互**

* [ ] 文本中黑话高亮（沿用全站 hover tooltip 规则）
* [ ] 点击高亮词 → `addPhrase(term)` + 右侧词典新增一条
* [ ] 提供“进入翻译圣坛（爬塔）”按钮进入 F1

---

## F. 三个挑战组件升级（2–4 天）

11. **F1 关键词锻炉（Keyword Challenge）**

* [ ] 保留单选题结构
* [ ] 新增连击 streak：
  * [ ] 连续答对计数 UI（小徽章/连击数字）
  * [ ] 达到 3 连击后正确奖励提升
* [ ] 每题显示 strategy 标签（音译/意译/归化）
* [ ] 首通掉落 rune：通关弹“获得××符”

12. **F2 语气熔炉（Style Challenge）**

* [ ] 维持二选一对比卡
* [ ] 加中部双条反馈（Culture/Clarity 拉扯条）
* [ ] 增加 “注释键 Gloss”（每轮 2 次）：
  * [ ] 点击后在译文后自动加括号注释
  * [ ] 使 Clarity 小幅上升但 Culture 不下降
* [ ] 阿里反应台词根据选择切换（易懂/保留文化）

13. **F3 隐喻回廊（Metaphor Challenge）**

* [ ] 从“连线题”改为“拖拽匹配”
* [ ] 每匹配成功点亮回廊灯格（进度条/点亮动画）
* [ ] 全部完成后结算：culture 明显上升 + 掉落 rune（可选）

---

## G. F4 Boss：拼装翻译台（2–3 天）

14. **重做 `layout/FinalTask` → `BossAssembler`**

* [ ] 左栏原文分段显示（5 槽位对应）
* [ ] 中栏拼装区：
  * [ ] 每槽位“点击选择”即可（可选：拖拽增强）
  * [ ] 已选短语可替换
* [ ] 右栏资源：
  * [ ] 已获 runes 展示（小图标+数量）
  * [ ] hintTickets 展示 + 使用按钮（消耗一次排除一个坏选项/高亮推荐）
  * [ ] phrasebook 列表（点击可弹出解释）

15. **即时反馈与结果**

* [ ] 每次更换短语：实时计算总 Clarity/Culture 预估变化并展示
* [ ] 阿里反应：困惑/点头/兴奋三态切换
* [ ] 提交后输出：
  * [ ] 最终译文一段（拼好的整句）
  * [ ] 译者旁白：你的策略偏向（更圈内/更对外）
  * [ ] 系统给一条替代版本（展示多解）

---

## H. Settlement 结算与奖励（0.5–1 天）

16. **复用你的结算 UI（EXP 条 + 成就卡 + 按钮组）**

* [ ] 结算卡字段补齐：
  * [ ] 本章最终三轴数值
  * [ ] 获得 runes 数量
  * [ ] phrasebook 收集数
  * [ ] 提示券使用次数
* [ ] 奖励技能卡：言灵·转化（Logos Conversion）
* [ ] 结尾对白：阿里成功组队 + “文化桥梁”收束句

---

## I. 视觉与动效微调（1–2 天）

17. **统一像素/RPG UI 皮肤规则**

* [ ] 卡片边框、按钮 hover/pressed 状态统一
* [ ] tooltip 样式与全站一致（暗底亮边）
* [ ] 锁定态（灰度+抖动提示“未解锁”）

18. **关键爽点动效**

* [ ] 获得 rune：小弹窗 + icon 飞入右侧资源栏
* [ ] 回廊点亮：格子逐个亮起
* [ ] Boss 拼装完成：整句译文“装配完成”短闪光

---

## J. 测试与验收（1 天）

19. **功能测试清单**

* [ ] 全流程可跑通（不刷新）
* [ ] 刷新后状态策略（是否允许断点续玩）符合预期
* [ ] comms 归零能重试不崩
* [ ] phrasebook 点击/收集/显示无重复或有去重策略
* [ ] hintTickets 使用正确扣除并生效

20. **内容验收清单**

* [ ] 所有黑话 hover tooltip 正常
* [ ] 文案无明显中英混乱/错别字
* [ ] 终局译文至少能组合出 3 种风格（圈内/折中/对外）

---

## K. 可选增强（有余力再做）

21. **塔爬“周目”**

* [ ] 通关后解锁“二周目”按钮：提示更少、干扰更多、奖励成就

22. **数据记录（埋点）**

* [ ] 记录用户每题选择策略（音译/意译/归化/注释）
* [ ] Boss 最终策略分布，用于玩家档案室画像